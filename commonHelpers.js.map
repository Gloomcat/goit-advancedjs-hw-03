{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = null;\n\nconst refreshLightbox = () => {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  }\n\n  lightbox.refresh();\n};\n\nexport const toggleLoader = loader => {\n  if (loader.classList.contains('hidden')) {\n    showElement(loader, true);\n  } else {\n    showElement(loader, false);\n  }\n};\n\nexport const showElement = (el, show) => {\n  if (show) {\n    el.classList.remove('hidden');\n  } else {\n    el.classList.add('hidden');\n  }\n};\n\nexport const showErrorMessage = errorMessage => {\n  let settings = {\n    titleSize: '16px',\n    titleLineHeight: '24px',\n    titleColor: '#FFF',\n    messageSize: '16px',\n    messageLineHeight: '24px',\n    messageColor: '#FFF',\n    theme: 'dark',\n    position: 'topRight',\n    title: 'Error',\n    backgroundColor: '#EF4040',\n    message: errorMessage,\n  };\n\n  iziToast.error(settings);\n};\n\nexport const fillGallery = (gallery, photosList) => {\n  const galleryItems = photosList.map(photo => {\n    return `\n        <div class='gallery-item'>\n            <a href=\"${photo.largeImageURL}\" class=\"gallery-link\">\n                <img src=\"${photo.previewURL}\" alt=\"${photo.tags}\" loading=\"lazy\" width=\"360\" height=\"150\"/>\n            </a>\n            <ul class=\"info\">\n                <li class=\"info-item\">\n                    <p class=\"info-category\">Likes</p>\n                    <p class=>${photo.likes}</p>\n                </li>\n                <li class=\"info-item\">\n                    <p class=\"info-category\">Views</p>\n                    <p class=>${photo.views}</p>\n                </li>\n                <li class=\"info-item\">\n                    <p class=\"info-category\">Comments</p>\n                    <p class=>${photo.comments}</p>\n                </li>\n                <li class=\"info-item\">\n                    <p class=\"info-category\">Downloads</p>\n                    <p class=>${photo.downloads}</p>\n                </li>\n            </ul>\n        </div>\n        `;\n  });\n  gallery.innerHTML = galleryItems.join('\\n');\n  refreshLightbox();\n};\n\nexport const clearGallery = gallery => {\n  gallery.innerHTML = '';\n  refreshLightbox();\n};\n","import { showErrorMessage } from './render-functions';\n\nconst API_KEY = '45271330-704da2140a32d702981ddfad2';\n\nexport const fetchPhotos = (query, page) => {\n  return fetch(\n    `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(\n      query\n    )}&orientation=horizontal&safesearch=true&per_page=9&page=${page}`\n  )\n    .then(response => {\n      if (!response.ok) {\n        throw new Error(\n          `Failed to load images, error code: ${response.status}`\n        );\n      }\n\n      return response.json();\n    })\n    .catch(error => {\n      showErrorMessage(error.message);\n    });\n};\n","import { fetchPhotos } from './js/pixabay-api';\nimport {\n  clearGallery,\n  fillGallery,\n  toggleLoader,\n  showErrorMessage,\n  showElement,\n} from './js/render-functions';\n\nclass GalleryController {\n  #currentPage;\n  #totalPages;\n  #query;\n  #gallery;\n  #loader;\n  #pageCounter;\n\n  constructor() {\n    this.form = document.querySelector('.form');\n    this.leftArrow = document.querySelector('.left');\n    this.rightArrow = document.querySelector('.right');\n    this.#gallery = document.querySelector('.gallery');\n    this.#loader = document.querySelector('.loader');\n    this.#pageCounter = document.querySelector('.page');\n\n    this.#currentPage = 0;\n    this.#totalPages = 0;\n    this.#query = '';\n  }\n\n  fetchNext() {\n    if (!this.#totalPages) {\n      this.#currentPage = 1;\n      this.#fetch();\n    }\n\n    if (this.#currentPage <= this.#totalPages) {\n      this.#currentPage++;\n      this.#fetch();\n    }\n  }\n\n  fetchPrevious() {\n    if (!this.#totalPages) {\n      return;\n    }\n\n    if (this.#currentPage > 1) {\n      this.#currentPage--;\n      this.#fetch();\n    }\n  }\n\n  setupQuery() {\n    const q = this.form.querySelector('input[name=\"query\"]').value.trim();\n    this.form.reset();\n    if (!q) {\n      showErrorMessage('Search request should not be empty. Please try again!');\n      return false;\n    }\n\n    this.#query = q;\n    return true;\n  }\n\n  reset() {\n    showElement(this.leftArrow, false);\n    showElement(this.rightArrow, false);\n    showElement(this.#pageCounter, false);\n    this.#pageCounter.textContent = '';\n\n    this.#query = '';\n    this.#currentPage = 0;\n    this.#totalPages = 0;\n  }\n\n  #fetch() {\n    showElement(this.leftArrow, false);\n    showElement(this.rightArrow, false);\n    showElement(this.#pageCounter, false);\n    this.#pageCounter.textContent = '';\n\n    clearGallery(this.#gallery);\n    toggleLoader(this.#loader);\n\n    fetchPhotos(this.#query, this.#currentPage)\n      .then(photosData => {\n        toggleLoader(this.#loader);\n        if (!this.#totalPages) {\n          const total = parseInt(photosData.totalHits);\n          this.#totalPages = Math.floor(total / 9) + (total % 9 > 0 ? 1 : 0);\n        }\n\n        if (this.#totalPages > 0) {\n          fillGallery(this.#gallery, photosData.hits);\n        } else {\n          throw new Error(\n            'Sorry, there are no images matching your search query. Please try again!'\n          );\n        }\n\n        this.#pageCounter.textContent = `${this.#currentPage}  of  ${\n          this.#totalPages\n        }`;\n        showElement(this.#pageCounter, true);\n\n        if (this.#totalPages > 1) {\n          if (this.#currentPage === this.#totalPages) {\n            showElement(this.rightArrow, false);\n            showElement(this.leftArrow, true);\n          } else if (this.#currentPage === 1) {\n            showElement(this.leftArrow, false);\n            showElement(this.rightArrow, true);\n          } else {\n            showElement(this.rightArrow, true);\n            showElement(this.leftArrow, true);\n          }\n        }\n      })\n      .catch(error => {\n        showErrorMessage(error.message);\n      });\n  }\n}\n\nconst galleryController = new GalleryController();\n\ngalleryController.form.addEventListener('submit', event => {\n  event.preventDefault();\n\n  galleryController.reset();\n  if (galleryController.setupQuery()) {\n    galleryController.fetchNext();\n  }\n});\n\ngalleryController.rightArrow.addEventListener('click', _ => {\n  galleryController.fetchNext();\n});\n\ngalleryController.leftArrow.addEventListener('click', _ => {\n  galleryController.fetchPrevious();\n});\n"],"names":["lightbox","refreshLightbox","SimpleLightbox","toggleLoader","loader","showElement","el","show","showErrorMessage","errorMessage","settings","iziToast","fillGallery","gallery","photosList","galleryItems","photo","clearGallery","API_KEY","fetchPhotos","query","page","response","error","GalleryController","__privateAdd","_fetch","_currentPage","_totalPages","_query","_gallery","_loader","_pageCounter","__privateSet","__privateGet","__privateMethod","fetch_fn","__privateWrapper","q","photosData","total","galleryController","event","_"],"mappings":"isCAKA,IAAIA,EAAW,KAEf,MAAMC,EAAkB,IAAM,CACvBD,IACHA,EAAW,IAAIE,EAAe,aAAc,CAC1C,aAAc,MACd,aAAc,GACpB,CAAK,GAGHF,EAAS,QAAO,CAClB,EAEaG,EAAeC,GAAU,CAChCA,EAAO,UAAU,SAAS,QAAQ,EACpCC,EAAYD,EAAQ,EAAI,EAExBC,EAAYD,EAAQ,EAAK,CAE7B,EAEaC,EAAc,CAACC,EAAIC,IAAS,CACnCA,EACFD,EAAG,UAAU,OAAO,QAAQ,EAE5BA,EAAG,UAAU,IAAI,QAAQ,CAE7B,EAEaE,EAAmBC,GAAgB,CAC9C,IAAIC,EAAW,CACb,UAAW,OACX,gBAAiB,OACjB,WAAY,OACZ,YAAa,OACb,kBAAmB,OACnB,aAAc,OACd,MAAO,OACP,SAAU,WACV,MAAO,QACP,gBAAiB,UACjB,QAASD,CACb,EAEEE,EAAS,MAAMD,CAAQ,CACzB,EAEaE,EAAc,CAACC,EAASC,IAAe,CAClD,MAAMC,EAAeD,EAAW,IAAIE,GAC3B;AAAA;AAAA,uBAEYA,EAAM,aAAa;AAAA,4BACdA,EAAM,UAAU,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,gCAKhCA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,gCAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,gCAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,gCAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,SAK5C,EACDH,EAAQ,UAAYE,EAAa,KAAK;AAAA,CAAI,EAC1Cd,GACF,EAEagB,EAAeJ,GAAW,CACrCA,EAAQ,UAAY,GACpBZ,GACF,ECrFMiB,EAAU,qCAEHC,EAAc,CAACC,EAAOC,IAC1B,MACL,gCAAgCH,CAAO,MAAM,mBAC3CE,CACN,CAAK,2DAA2DC,CAAI,EACjE,EACE,KAAKC,GAAY,CAChB,GAAI,CAACA,EAAS,GACZ,MAAM,IAAI,MACR,sCAAsCA,EAAS,MAAM,EAC/D,EAGM,OAAOA,EAAS,MACtB,CAAK,EACA,MAAMC,GAAS,CACdf,EAAiBe,EAAM,OAAO,CACpC,CAAK,sBCZL,MAAMC,CAAkB,CAQtB,aAAc,CA2DdC,EAAA,KAAAC,GAlEAD,EAAA,KAAAE,EAAA,QACAF,EAAA,KAAAG,EAAA,QACAH,EAAA,KAAAI,EAAA,QACAJ,EAAA,KAAAK,EAAA,QACAL,EAAA,KAAAM,EAAA,QACAN,EAAA,KAAAO,EAAA,QAGE,KAAK,KAAO,SAAS,cAAc,OAAO,EAC1C,KAAK,UAAY,SAAS,cAAc,OAAO,EAC/C,KAAK,WAAa,SAAS,cAAc,QAAQ,EACjDC,EAAA,KAAKH,EAAW,SAAS,cAAc,UAAU,GACjDG,EAAA,KAAKF,EAAU,SAAS,cAAc,SAAS,GAC/CE,EAAA,KAAKD,EAAe,SAAS,cAAc,OAAO,GAElDC,EAAA,KAAKN,EAAe,GACpBM,EAAA,KAAKL,EAAc,GACnBK,EAAA,KAAKJ,EAAS,GACf,CAED,WAAY,CACLK,EAAA,KAAKN,KACRK,EAAA,KAAKN,EAAe,GACpBQ,EAAA,KAAKT,EAAAU,GAAL,YAGEF,EAAA,KAAKP,IAAgBO,EAAA,KAAKN,KAC5BS,EAAA,KAAKV,GAAL,IACAQ,EAAA,KAAKT,EAAAU,GAAL,WAEH,CAED,eAAgB,CACTF,EAAA,KAAKN,IAINM,EAAA,KAAKP,GAAe,IACtBU,EAAA,KAAKV,GAAL,IACAQ,EAAA,KAAKT,EAAAU,GAAL,WAEH,CAED,YAAa,CACX,MAAME,EAAI,KAAK,KAAK,cAAc,qBAAqB,EAAE,MAAM,OAE/D,OADA,KAAK,KAAK,QACLA,GAKLL,EAAA,KAAKJ,EAASS,GACP,KALL9B,EAAiB,uDAAuD,EACjE,GAKV,CAED,OAAQ,CACNH,EAAY,KAAK,UAAW,EAAK,EACjCA,EAAY,KAAK,WAAY,EAAK,EAClCA,EAAY6B,EAAA,KAAKF,GAAc,EAAK,EACpCE,EAAA,KAAKF,GAAa,YAAc,GAEhCC,EAAA,KAAKJ,EAAS,IACdI,EAAA,KAAKN,EAAe,GACpBM,EAAA,KAAKL,EAAc,EACpB,CAiDH,CAjHED,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YA6DAN,EAAA,YAAAU,EAAM,UAAG,CACP/B,EAAY,KAAK,UAAW,EAAK,EACjCA,EAAY,KAAK,WAAY,EAAK,EAClCA,EAAY6B,EAAA,KAAKF,GAAc,EAAK,EACpCE,EAAA,KAAKF,GAAa,YAAc,GAEhCf,EAAaiB,EAAA,KAAKJ,EAAQ,EAC1B3B,EAAa+B,EAAA,KAAKH,EAAO,EAEzBZ,EAAYe,EAAA,KAAKL,GAAQK,EAAA,KAAKP,EAAY,EACvC,KAAKY,GAAc,CAElB,GADApC,EAAa+B,EAAA,KAAKH,EAAO,EACrB,CAACG,EAAA,KAAKN,GAAa,CACrB,MAAMY,EAAQ,SAASD,EAAW,SAAS,EAC3CN,EAAA,KAAKL,EAAc,KAAK,MAAMY,EAAQ,CAAC,GAAKA,EAAQ,EAAI,EAAI,EAAI,GACjE,CAED,GAAIN,EAAA,KAAKN,GAAc,EACrBhB,EAAYsB,EAAA,KAAKJ,GAAUS,EAAW,IAAI,MAE1C,OAAM,IAAI,MACR,0EACZ,EAGQL,EAAA,KAAKF,GAAa,YAAc,GAAGE,EAAA,KAAKP,EAAY,SAClDO,EAAA,KAAKN,EACf,GACQvB,EAAY6B,EAAA,KAAKF,GAAc,EAAI,EAE/BE,EAAA,KAAKN,GAAc,IACjBM,EAAA,KAAKP,KAAiBO,EAAA,KAAKN,IAC7BvB,EAAY,KAAK,WAAY,EAAK,EAClCA,EAAY,KAAK,UAAW,EAAI,GACvB6B,EAAA,KAAKP,KAAiB,GAC/BtB,EAAY,KAAK,UAAW,EAAK,EACjCA,EAAY,KAAK,WAAY,EAAI,IAEjCA,EAAY,KAAK,WAAY,EAAI,EACjCA,EAAY,KAAK,UAAW,EAAI,GAG5C,CAAO,EACA,MAAMkB,GAAS,CACdf,EAAiBe,EAAM,OAAO,CACtC,CAAO,CACJ,EAGH,MAAMkB,EAAoB,IAAIjB,EAE9BiB,EAAkB,KAAK,iBAAiB,SAAUC,GAAS,CACzDA,EAAM,eAAc,EAEpBD,EAAkB,MAAK,EACnBA,EAAkB,cACpBA,EAAkB,UAAS,CAE/B,CAAC,EAEDA,EAAkB,WAAW,iBAAiB,QAASE,GAAK,CAC1DF,EAAkB,UAAS,CAC7B,CAAC,EAEDA,EAAkB,UAAU,iBAAiB,QAASE,GAAK,CACzDF,EAAkB,cAAa,CACjC,CAAC"}